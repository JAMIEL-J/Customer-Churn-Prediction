# Customer Churn Prediction with Business Impact Analysis

<div align="center">

### ğŸŒ [**ğŸ‘‰ Live Demo**](https://customer-churn-prediction-with-business-analysis.streamlit.app/) â† Click to Try!

---

![Python](https://img.shields.io/badge/Python-3.9+-blue.svg)
![Scikit-Learn](https://img.shields.io/badge/Scikit--Learn-1.3+-orange.svg)
![Streamlit](https://img.shields.io/badge/Streamlit-1.28+-red.svg)
![License](https://img.shields.io/badge/License-MIT-green.svg)

**A decision-focused churn prediction system that optimizes retention strategy using business-aware threshold selection and ROI analysis.**

[Overview](#-overview) â€¢
[Features](#-key-features) â€¢
[Installation](#-installation) â€¢
[Usage](#-usage) â€¢
[Architecture](#-project-architecture) â€¢
[Results](#-results)

</div>

---

## ğŸ“‹ Overview

This project extends traditional churn prediction by connecting **machine learning models** to **business decision-making**. Rather than simply predicting which customers will churn, it addresses the question: **"What should we do about it, and what's the expected ROI?"**

### The Problem
- Customer churn directly impacts revenue
- Traditional ML models predict churn but don't specify *who* to contact or *how much* to spend
- Without proper threshold optimization, businesses either overspend on retention or miss at-risk customers

### The Solution
- **Hypothesis-driven feature engineering** based on validated business assumptions
- **Cost-benefit analysis** with business metrics (CLV, retention cost, success rate)
- **Optimal threshold selection** based on **ROI, not accuracy**
- **Segment-specific strategies** for high-value vs. low-value customers
- **Interactive dashboard** for exploring decision trade-offs

---

## âœ¨ Key Features

| Feature | Description |
|---------|-------------|
| ğŸ“Š **Exploratory Data Analysis** | EDA with 14 business hypotheses validated |
| ğŸ”§ **Feature Engineering** | 24 hypothesis-driven features across 3 business buckets |
| ğŸ¤– **Baseline Modeling** | Logistic Regression + Random Forest with interpretable outputs |
| ğŸ’° **Business Impact Analysis** | Cost matrix, threshold sweep, ROI optimization |
| ğŸ‘¥ **Customer Segmentation** | Value-based targeting with segment-specific thresholds |
| ğŸ“ˆ **Interactive Dashboard** | Streamlit app for decision support |

---

## ğŸš€ Installation

### Prerequisites
- Python 3.9 or higher
- pip package manager

### Setup

```bash
# Clone the repository
git clone https://github.com/yourusername/customer-churn-prediction.git
cd customer-churn-prediction

# Create virtual environment (recommended)
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate

# Install dependencies
pip install -r requirements.txt
```

---

## ğŸ’¡ Usage

### 1. Run the Analysis Notebooks

Execute the notebooks in sequence to build the complete analysis pipeline:

```bash
# Navigate to notebooks directory
cd notebooks

# Run in order:
# 1. 01_eda.ipynb               â†’ Exploratory Data Analysis
# 2. 02_feature_engineering.ipynb â†’ Feature Engineering
# 3. 03_modeling.ipynb          â†’ Model Training
# 4. 04_business_impact.ipynb   â†’ Business Analysis
```

### 2. Launch the Dashboard

```bash
# From project root
streamlit run dashboard/app.py
```

The dashboard provides four views:
- **ğŸ“Š Overview** â€” Executive snapshot of churn impact
- **ğŸ¯ Decision Tool** â€” Interactive threshold optimization
- **ğŸ‘¥ Segments** â€” Customer targeting and prioritization
- **ğŸ” Explainability** â€” Feature importance and model insights

> **Note for Streamlit Cloud deployment**: The dashboard loads pre-computed models and reports generated by the notebooks. Ensure all notebooks are run and outputs are committed before deploying.

---

## ğŸ“ Project Architecture

```
customer-churn-prediction/
â”‚
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/                    # Original dataset
â”‚   â””â”€â”€ processed/              # Engineered features
â”‚
â”œâ”€â”€ notebooks/
â”‚   â”œâ”€â”€ 01_eda.ipynb            # Exploratory Data Analysis
â”‚   â”œâ”€â”€ 02_feature_engineering.ipynb  # Feature Engineering
â”‚   â”œâ”€â”€ 03_modeling.ipynb       # Model Training & Evaluation
â”‚   â””â”€â”€ 04_business_impact.ipynb      # ROI & Threshold Analysis
â”‚
â”œâ”€â”€ models/                     # Trained model artifacts
â”‚   â”œâ”€â”€ logistic_regression.pkl
â”‚   â”œâ”€â”€ random_forest.pkl
â”‚   â”œâ”€â”€ scaler.pkl
â”‚   â””â”€â”€ feature_cols.txt
â”‚
â”œâ”€â”€ business/                   # Business logic modules
â”‚   â”œâ”€â”€ cost_matrix.py          # CLV & cost calculations
â”‚   â”œâ”€â”€ threshold_optimization.py  # Threshold sweep logic
â”‚   â”œâ”€â”€ roi_analysis.py         # ROI calculations
â”‚   â””â”€â”€ segment_strategy.py     # Segmentation strategies
â”‚
â”œâ”€â”€ dashboard/                  # Streamlit application
â”‚   â”œâ”€â”€ app.py                  # Main entry point
â”‚   â””â”€â”€ pages/
â”‚       â”œâ”€â”€ Overview.py
â”‚       â”œâ”€â”€ Decision_Tool.py
â”‚       â”œâ”€â”€ Segments.py
â”‚       â””â”€â”€ Explainability.py
â”‚
â”œâ”€â”€ reports/                    # Generated analysis outputs
â”‚   â”œâ”€â”€ business_recommendations.csv
â”‚   â”œâ”€â”€ lr_threshold_sweep.csv
â”‚   â””â”€â”€ rf_threshold_sweep.csv
â”‚
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
```

---

## ğŸ“Š Results

### Model Performance

| Model | Optimal Threshold | Recall | Precision | Net ROI |
|-------|-------------------|--------|-----------|---------|
| Logistic Regression | 0.35 | 94.65% | 54.71% | $105,204 |
| Random Forest | 0.20 | 96.52% | 53.24% | $106,374 |

### Key Findings

- **Recommended Model**: Random Forest at threshold 0.20
- **Customers to Contact**: ~678 (out of 1,409 in test set)
- **Revenue Saved**: $140,274
- **Retention Cost**: $33,900
- **Net ROI**: $106,374

### Segment Strategy

Using segment-specific thresholds instead of a single threshold can provide additional value by optimizing interventions for high-value vs. low-value customers.

---

## ğŸ”¬ Methodology

### Feature Engineering Buckets

1. **Tenure & Contract Structure**
   - Tenure buckets (new, established, loyal, long-term)
   - Contract type indicators
   - Month-to-month risk flags

2. **Pricing Pressure**
   - Average monthly charge
   - Charge-to-tenure ratio
   - High-charge flags

3. **Service Dependency**
   - Add-on service counts
   - Service coverage scores
   - Internet service type indicators

### Financial Assumptions

> âš ï¸ **Disclaimer**: The financial parameters below are illustrative estimates used for demonstration purposes. In a production environment, these values should be validated with actual business data and stakeholder input.

| Parameter | Value | Rationale |
|-----------|-------|-----------|
| CLV | ~$1,554 | Avg monthly charge ($64.76) Ã— 24 months |
| Retention Cost | $50 | Estimated cost per retention intervention |
| Success Rate | 25% | Assumed probability of saving an at-risk customer |

---

## ğŸ› ï¸ Tech Stack

- **Data Processing**: pandas, numpy
- **Machine Learning**: scikit-learn
- **Visualization**: matplotlib, seaborn
- **Dashboard**: Streamlit
- **Model Persistence**: joblib

---

## ğŸ“¦ Deployment Note

This project is deployed as a Streamlit-based decision-support prototype to demonstrate how churn predictions translate into retention actions and quantified business impact. It is not a production ML system and does not include live data ingestion, automated retraining, or real-time monitoring.

---

## ğŸ“œ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---

## ğŸ“§ Contact

For questions or feedback, please open an issue in this repository.
